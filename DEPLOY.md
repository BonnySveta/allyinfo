# Инструкции по развертыванию

## Подготовка к деплою

1. Убедитесь, что у вас есть:
   - Аккаунт Supabase с настроенным проектом
   - Доступ к хостингу для клиентской части
   - Доступ к серверу для серверной части
   - Настроенные переменные окружения

2. Проверьте переменные окружения:
   ```env
   VITE_SUPABASE_URL=your_supabase_url
   VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
   ```

## Деплой клиентской части

### Вариант 1: Статический хостинг (Netlify, Vercel, GitHub Pages)

1. Соберите клиентскую часть:
   ```bash
   npm run build:client
   ```

2. Загрузите содержимое папки `a11y-handbook/build` на ваш хостинг

### Вариант 2: Автоматический деплой

1. Подключите ваш репозиторий к Netlify/Vercel
2. Настройте следующие параметры:
   - Build command: `npm run build:client`
   - Publish directory: `a11y-handbook/build`
   - Environment variables: добавьте переменные из `.env`

## Деплой серверной части

### Вариант 1: VPS (DigitalOcean, AWS, etc.)

1. Соберите серверную часть:
   ```bash
   npm run build:server
   ```

2. Загрузите содержимое папки `server/dist` на ваш сервер

3. Установите зависимости:
   ```bash
   npm install --production
   ```

4. Запустите сервер:
   ```bash
   npm run start:server
   ```

### Вариант 2: Docker

1. Создайте Dockerfile:
   ```dockerfile
   FROM node:18-alpine
   WORKDIR /app
   COPY package*.json ./
   RUN npm install --production
   COPY . .
   RUN npm run build:server
   EXPOSE 3000
   CMD ["npm", "run", "start:server"]
   ```

2. Соберите и запустите контейнер:
   ```bash
   docker build -t allys-library-server .
   docker run -p 3000:3000 allys-library-server
   ```

## Настройка Supabase

1. Создайте новый проект в Supabase

2. Импортируйте схему базы данных:
   - Создайте таблицы: `resources`, `categories`, `sections`, `resource_categories`
   - Настройте RLS политики
   - Создайте необходимые индексы

3. Настройте аутентификацию:
   - Включите Email/Password аутентификацию
   - Настройте правила доступа
   - Создайте первого администратора

4. Настройте Storage:
   - Создайте бакет для загрузки файлов
   - Настройте политики доступа

## Проверка после деплоя

1. Проверьте доступность клиентской части
2. Проверьте работу аутентификации
3. Проверьте загрузку и отображение материалов
4. Проверьте работу фильтрации
5. Проверьте работу парсера метаданных

## Мониторинг и поддержка

1. Настройте логирование:
   - Логи сервера
   - Логи клиента
   - Логи Supabase

2. Настройте мониторинг:
   - Uptime мониторинг
   - Мониторинг производительности
   - Мониторинг ошибок

3. Настройте бэкапы:
   - Регулярное резервное копирование базы данных
   - Бэкапы файлов в Storage

## Обновление

1. Получите последние изменения:
   ```bash
   git pull origin main
   ```

2. Обновите зависимости:
   ```bash
   npm install
   ```

3. Пересоберите и перезапустите:
   ```bash
   npm run deploy:all
   ``` 